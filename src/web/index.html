<!--
Character Counter - A simple tool to count characters copied to the clipboard.
Copyright (C) 2025 molyashi

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as published
by the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with this program.  If not, see <https://www.gnu.org/licenses/>.
-->

<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>文字数カウンター</title>
    <script>
      if (typeof snapshotResult !== 'undefined') {
        const path = require('path');
        const Module = require('module');

        const entryPointDirPath = path.dirname(require.resolve('electron'));

        const originalRequire = Module.prototype.require;
        Module.prototype.require = function (module) {
          try {
            const absoluteFilePath = Module._resolveFilename(module, this, false);

            if (absoluteFilePath.includes('node_modules')) {
              let relativeFilePath = path.relative(entryPointDirPath, absoluteFilePath);

              if (!relativeFilePath.startsWith('./')) {
                relativeFilePath = `./${relativeFilePath}`;
              }
              if (process.platform === 'win32') {
                relativeFilePath = relativeFilePath.replace(/\\/g, '/');
              }

              const cachedModule = snapshotResult.customRequire.cache[relativeFilePath];
              if (cachedModule) {
                return cachedModule.exports;
              }
            }
          } catch(e) {
            // ignore
          }

          return originalRequire.apply(this, arguments);
        };

        snapshotResult.setGlobals(
          global,
          process,
          window,
          document,
          console,
          global.require
        );
      }
    </script>
  </head>
  <body>
    <div id="root"></div>
  </body>
</html>